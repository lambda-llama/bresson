<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>src/Data/Bson/Binary.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE OverloadedStrings #-}</span>
<a name="line-2"></a><span class='hs-comment'>{-# LANGUAGE TypeSynonymInstances #-}</span>
<a name="line-3"></a><span class='hs-comment'>{-# LANGUAGE FlexibleInstances #-}</span>
<a name="line-4"></a><span class='hs-comment'>{-# LANGUAGE RecordWildCards #-}</span>
<a name="line-5"></a><span class='hs-comment'>{-# LANGUAGE TupleSections #-}</span>
<a name="line-6"></a><span class='hs-comment'>{-# LANGUAGE CPP #-}</span>
<a name="line-7"></a>
<a name="line-8"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Bson</span><span class='hs-varop'>.</span><span class='hs-conid'>Binary</span>
<a name="line-9"></a>    <span class='hs-layout'>(</span> <span class='hs-varid'>putField</span>
<a name="line-10"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>getField</span>
<a name="line-11"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>putDocument</span>
<a name="line-12"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>getDocument</span>
<a name="line-13"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>putArray</span>
<a name="line-14"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>getArray</span>
<a name="line-15"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>putBinary</span>
<a name="line-16"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>getBinary</span>
<a name="line-17"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>putObjectId</span>
<a name="line-18"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>getObjectId</span>
<a name="line-19"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>putUtcTime</span>
<a name="line-20"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>getUtcTime</span>
<a name="line-21"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>putRegexOptions</span>
<a name="line-22"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>getRegexOptions</span>
<a name="line-23"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>putJsWithScope</span>
<a name="line-24"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>getJsWithScope</span>
<a name="line-25"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>putCString</span>
<a name="line-26"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>getCString</span>
<a name="line-27"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>putString</span>
<a name="line-28"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>getString</span>
<a name="line-29"></a>    <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-30"></a>
<a name="line-31"></a><span class='hs-cpp'>#include "bson.h"</span>
<a name="line-32"></a>
<a name="line-33"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span><span class='hs-layout'>,</span> <span class='hs-varid'>concat</span><span class='hs-layout'>)</span>
<a name="line-34"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Control</span><span class='hs-varop'>.</span><span class='hs-conid'>Applicative</span> <span class='hs-layout'>(</span><span class='hs-varid'>pure</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>&lt;$&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>&lt;*&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>*&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-35"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Binary</span> <span class='hs-layout'>(</span><span class='hs-varid'>get</span><span class='hs-layout'>,</span> <span class='hs-varid'>put</span><span class='hs-layout'>)</span>
<a name="line-36"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Binary</span><span class='hs-varop'>.</span><span class='hs-conid'>Get</span> <span class='hs-layout'>(</span><span class='hs-conid'>Get</span><span class='hs-layout'>,</span> <span class='hs-varid'>runGet</span><span class='hs-layout'>,</span> <span class='hs-varid'>getWord8</span><span class='hs-layout'>,</span> <span class='hs-varid'>getWord16le</span><span class='hs-layout'>,</span>
<a name="line-37"></a>                        <span class='hs-varid'>getWord32le</span><span class='hs-layout'>,</span> <span class='hs-varid'>getWord64le</span><span class='hs-layout'>,</span> <span class='hs-varid'>getLazyByteStringNul</span><span class='hs-layout'>,</span>
<a name="line-38"></a>                        <span class='hs-varid'>getLazyByteString</span><span class='hs-layout'>,</span> <span class='hs-varid'>getByteString</span><span class='hs-layout'>,</span> <span class='hs-varid'>lookAhead</span><span class='hs-layout'>)</span>
<a name="line-39"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Binary</span><span class='hs-varop'>.</span><span class='hs-conid'>Put</span> <span class='hs-layout'>(</span><span class='hs-conid'>Put</span><span class='hs-layout'>,</span> <span class='hs-varid'>runPut</span><span class='hs-layout'>,</span> <span class='hs-varid'>putWord8</span><span class='hs-layout'>,</span> <span class='hs-varid'>putWord16le</span><span class='hs-layout'>,</span> <span class='hs-varid'>putWord32le</span><span class='hs-layout'>,</span>
<a name="line-40"></a>                        <span class='hs-varid'>putWord64le</span><span class='hs-layout'>,</span> <span class='hs-varid'>putLazyByteString</span><span class='hs-layout'>,</span> <span class='hs-varid'>putByteString</span><span class='hs-layout'>)</span>
<a name="line-41"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Bits</span> <span class='hs-layout'>(</span><span class='hs-varid'>shiftL</span><span class='hs-layout'>,</span> <span class='hs-varid'>shiftR</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>.|.</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-42"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Time</span><span class='hs-varop'>.</span><span class='hs-conid'>Clock</span> <span class='hs-layout'>(</span><span class='hs-conid'>UTCTime</span><span class='hs-layout'>)</span>
<a name="line-43"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Time</span><span class='hs-varop'>.</span><span class='hs-conid'>Clock</span><span class='hs-varop'>.</span><span class='hs-conid'>POSIX</span> <span class='hs-layout'>(</span><span class='hs-varid'>posixSecondsToUTCTime</span><span class='hs-layout'>,</span> <span class='hs-varid'>utcTimeToPOSIXSeconds</span><span class='hs-layout'>)</span>
<a name="line-44"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Text</span><span class='hs-varop'>.</span><span class='hs-conid'>Printf</span> <span class='hs-layout'>(</span><span class='hs-varid'>printf</span><span class='hs-layout'>)</span>
<a name="line-45"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Binary</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Binary</span>
<a name="line-46"></a>
<a name="line-47"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>S</span>
<a name="line-48"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span><span class='hs-varop'>.</span><span class='hs-conid'>Lazy</span><span class='hs-varop'>.</span><span class='hs-conid'>Char8</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>L</span>
<a name="line-49"></a>
<a name="line-50"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Binary</span><span class='hs-varop'>.</span><span class='hs-conid'>IEEE754</span> <span class='hs-layout'>(</span><span class='hs-varid'>getFloat64le</span><span class='hs-layout'>,</span> <span class='hs-varid'>putFloat64le</span><span class='hs-layout'>)</span>
<a name="line-51"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Text</span> <span class='hs-layout'>(</span><span class='hs-conid'>Text</span><span class='hs-layout'>)</span>
<a name="line-52"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Text</span><span class='hs-varop'>.</span><span class='hs-conid'>Lazy</span><span class='hs-varop'>.</span><span class='hs-conid'>Builder</span><span class='hs-varop'>.</span><span class='hs-conid'>Int</span> <span class='hs-layout'>(</span><span class='hs-varid'>decimal</span><span class='hs-layout'>)</span>
<a name="line-53"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Word</span><span class='hs-varop'>.</span><span class='hs-conid'>Word24</span> <span class='hs-layout'>(</span><span class='hs-conid'>Word24</span><span class='hs-layout'>)</span>
<a name="line-54"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>BitSet</span><span class='hs-varop'>.</span><span class='hs-conid'>Word</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>BitSet</span>
<a name="line-55"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Text</span><span class='hs-varop'>.</span><span class='hs-conid'>Lazy</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>TL</span>
<a name="line-56"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Text</span><span class='hs-varop'>.</span><span class='hs-conid'>Lazy</span><span class='hs-varop'>.</span><span class='hs-conid'>Builder</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>TL</span>
<a name="line-57"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Text</span><span class='hs-varop'>.</span><span class='hs-conid'>Encoding</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>TE</span>
<a name="line-58"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Vector</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Vector</span>
<a name="line-59"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>UUID</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>UUID</span>
<a name="line-60"></a>
<a name="line-61"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Bson</span><span class='hs-varop'>.</span><span class='hs-conid'>Types</span> <span class='hs-layout'>(</span><span class='hs-conid'>Document</span><span class='hs-layout'>,</span> <span class='hs-conid'>Array</span><span class='hs-layout'>,</span> <span class='hs-conid'>Label</span><span class='hs-layout'>,</span> <span class='hs-conid'>Value</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-62"></a>                        <span class='hs-conid'>Binary</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>ObjectId</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-63"></a>                        <span class='hs-conid'>RegexOption</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>RegexOptions</span><span class='hs-layout'>)</span>
<a name="line-64"></a>
<a name="line-65"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Bson</span><span class='hs-varop'>.</span><span class='hs-conid'>Document</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Doc</span>
<a name="line-66"></a>
<a name="line-67"></a><a name="instance%20Binary.Binary%20Document"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Binary</span><span class='hs-varop'>.</span><span class='hs-conid'>Binary</span> <span class='hs-conid'>Document</span> <span class='hs-keyword'>where</span>
<a name="line-68"></a>    <span class='hs-varid'>put</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>putDocument</span>
<a name="line-69"></a>    <span class='hs-comment'>{-# INLINE put #-}</span>
<a name="line-70"></a>    <span class='hs-varid'>get</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>getDocument</span>
<a name="line-71"></a>    <span class='hs-comment'>{-# INLINE get #-}</span>
<a name="line-72"></a>
<a name="line-73"></a><a name="putField"></a><span class='hs-definition'>putField</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Label</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Value</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Put</span>
<a name="line-74"></a><span class='hs-definition'>putField</span> <span class='hs-varid'>key</span> <span class='hs-varid'>value</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-75"></a>    <span class='hs-varid'>putWord8</span> <span class='hs-varid'>tag</span>
<a name="line-76"></a>    <span class='hs-varid'>putCString</span> <span class='hs-varid'>key</span>
<a name="line-77"></a>    <span class='hs-varid'>payload</span>
<a name="line-78"></a>  <span class='hs-keyword'>where</span>
<a name="line-79"></a>    <span class='hs-layout'>(</span><span class='hs-varid'>tag</span><span class='hs-layout'>,</span> <span class='hs-varid'>payload</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>value</span> <span class='hs-keyword'>of</span>
<a name="line-80"></a>        <span class='hs-conid'>ValueDouble</span> <span class='hs-varid'>a</span>     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_DOUBLE</span><span class='hs-layout'>,</span> <span class='hs-varid'>putFloat64le</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-81"></a>        <span class='hs-conid'>ValueString</span> <span class='hs-varid'>a</span>     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_STRING</span><span class='hs-layout'>,</span> <span class='hs-varid'>putString</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-82"></a>        <span class='hs-conid'>ValueDocument</span> <span class='hs-varid'>a</span>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_DOCUMENT</span><span class='hs-layout'>,</span> <span class='hs-varid'>putDocument</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-83"></a>        <span class='hs-conid'>ValueArray</span> <span class='hs-varid'>a</span>      <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_ARRAY</span><span class='hs-layout'>,</span> <span class='hs-varid'>putArray</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-84"></a>        <span class='hs-conid'>ValueBinary</span> <span class='hs-varid'>a</span>     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_BINARY</span><span class='hs-layout'>,</span> <span class='hs-varid'>putBinary</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-85"></a>        <span class='hs-conid'>ValueObjectId</span> <span class='hs-varid'>a</span>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_OID</span><span class='hs-layout'>,</span> <span class='hs-varid'>putObjectId</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-86"></a>        <span class='hs-conid'>ValueBool</span> <span class='hs-conid'>False</span>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_BOOLEAN</span><span class='hs-layout'>,</span> <span class='hs-varid'>putWord8</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span>
<a name="line-87"></a>        <span class='hs-conid'>ValueBool</span> <span class='hs-conid'>True</span>    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_BOOLEAN</span><span class='hs-layout'>,</span> <span class='hs-varid'>putWord8</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
<a name="line-88"></a>        <span class='hs-conid'>ValueUtcTime</span> <span class='hs-varid'>a</span>    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_UTC</span><span class='hs-layout'>,</span> <span class='hs-varid'>putUtcTime</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-89"></a>        <span class='hs-conid'>ValueNull</span>         <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_NULL</span><span class='hs-layout'>,</span> <span class='hs-varid'>return</span> <span class='hs-conid'>()</span><span class='hs-layout'>)</span>
<a name="line-90"></a>        <span class='hs-conid'>ValueRegex</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>    <span class='hs-keyglyph'>-&gt;</span>
<a name="line-91"></a>            <span class='hs-layout'>(</span><span class='hs-conid'>BSON_REGEX</span><span class='hs-layout'>,</span> <span class='hs-varid'>putCString</span> <span class='hs-varid'>a</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>putRegexOptions</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-92"></a>        <span class='hs-conid'>ValueJavascript</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_JS</span><span class='hs-layout'>,</span> <span class='hs-varid'>putString</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-93"></a>        <span class='hs-conid'>ValueJavascriptWithScope</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-94"></a>            <span class='hs-layout'>(</span><span class='hs-conid'>BSON_JS_WITH_SCOPE</span><span class='hs-layout'>,</span> <span class='hs-varid'>putJsWithScope</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-95"></a>        <span class='hs-conid'>ValueInt32</span> <span class='hs-varid'>a</span>      <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_INT32</span><span class='hs-layout'>,</span> <span class='hs-varid'>putWord32le</span> <span class='hs-varop'>$</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-96"></a>        <span class='hs-conid'>ValueInt64</span> <span class='hs-varid'>a</span>      <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_INT64</span><span class='hs-layout'>,</span> <span class='hs-varid'>putWord64le</span> <span class='hs-varop'>$</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-97"></a>        <span class='hs-conid'>ValueTimestamp</span> <span class='hs-varid'>a</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_TIMESTAMP</span><span class='hs-layout'>,</span> <span class='hs-varid'>putWord64le</span> <span class='hs-varop'>$</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-98"></a>        <span class='hs-conid'>ValueMin</span>          <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_MIN</span><span class='hs-layout'>,</span> <span class='hs-varid'>return</span> <span class='hs-conid'>()</span><span class='hs-layout'>)</span>
<a name="line-99"></a>        <span class='hs-conid'>ValueMax</span>          <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_MAX</span><span class='hs-layout'>,</span> <span class='hs-varid'>return</span> <span class='hs-conid'>()</span><span class='hs-layout'>)</span>
<a name="line-100"></a><span class='hs-comment'>{-# INLINE putField #-}</span>
<a name="line-101"></a>
<a name="line-102"></a><a name="getField"></a><span class='hs-definition'>getField</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Get</span> <span class='hs-layout'>(</span><span class='hs-conid'>Label</span><span class='hs-layout'>,</span> <span class='hs-conid'>Value</span><span class='hs-layout'>)</span>
<a name="line-103"></a><span class='hs-definition'>getField</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-104"></a>    <span class='hs-varid'>tag</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getWord8</span>
<a name="line-105"></a>    <span class='hs-varid'>key</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getCString</span>
<a name="line-106"></a>    <span class='hs-varid'>value</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>tag</span> <span class='hs-keyword'>of</span>
<a name="line-107"></a>        <span class='hs-conid'>BSON_DOUBLE</span>    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ValueDouble</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getFloat64le</span>
<a name="line-108"></a>        <span class='hs-conid'>BSON_STRING</span>    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ValueString</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getString</span>
<a name="line-109"></a>        <span class='hs-conid'>BSON_DOCUMENT</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ValueDocument</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getDocument</span>
<a name="line-110"></a>        <span class='hs-conid'>BSON_ARRAY</span>     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ValueArray</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getArray</span>
<a name="line-111"></a>        <span class='hs-conid'>BSON_BINARY</span>    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ValueBinary</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getBinary</span>
<a name="line-112"></a>        <span class='hs-conid'>BSON_OID</span>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ValueObjectId</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getObjectId</span>
<a name="line-113"></a>        <span class='hs-conid'>BSON_BOOLEAN</span>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ValueBool</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getBool</span>
<a name="line-114"></a>        <span class='hs-conid'>BSON_UTC</span>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ValueUtcTime</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getUtcTime</span>
<a name="line-115"></a>        <span class='hs-conid'>BSON_NULL</span>      <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-conid'>ValueNull</span>
<a name="line-116"></a>        <span class='hs-conid'>BSON_REGEX</span>     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ValueRegex</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getCString</span> <span class='hs-varop'>&lt;*&gt;</span> <span class='hs-varid'>getRegexOptions</span>
<a name="line-117"></a>        <span class='hs-conid'>BSON_JS</span>        <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ValueJavascript</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getString</span>
<a name="line-118"></a>        <span class='hs-conid'>BSON_JS_WITH_SCOPE</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>uncurry</span> <span class='hs-conid'>ValueJavascriptWithScope</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getJsWithScope</span>
<a name="line-119"></a>        <span class='hs-conid'>BSON_INT32</span>     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ValueInt32</span> <span class='hs-varop'>.</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getWord32le</span>
<a name="line-120"></a>        <span class='hs-conid'>BSON_INT64</span>     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ValueInt64</span> <span class='hs-varop'>.</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getWord64le</span>
<a name="line-121"></a>        <span class='hs-conid'>BSON_TIMESTAMP</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ValueTimestamp</span> <span class='hs-varop'>.</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getWord64le</span>
<a name="line-122"></a>        <span class='hs-conid'>BSON_MIN</span>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-conid'>ValueMin</span>
<a name="line-123"></a>        <span class='hs-conid'>BSON_MAX</span>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-conid'>ValueMax</span>
<a name="line-124"></a>        <span class='hs-keyword'>_</span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>fail</span> <span class='hs-varop'>$</span> <span class='hs-varid'>printf</span> <span class='hs-str'>"Invalid BSON tag: %i"</span> <span class='hs-varid'>tag</span>
<a name="line-125"></a>    <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-varid'>key</span><span class='hs-layout'>,</span> <span class='hs-varid'>value</span><span class='hs-layout'>)</span>
<a name="line-126"></a><span class='hs-comment'>{-# INLINE getField #-}</span>
<a name="line-127"></a>
<a name="line-128"></a><a name="putAsDocument"></a><span class='hs-definition'>putAsDocument</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Put</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Put</span>
<a name="line-129"></a><span class='hs-definition'>putAsDocument</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-130"></a>    <span class='hs-comment'>-- include length and null terminator</span>
<a name="line-131"></a>    <span class='hs-varid'>putWord32le</span> <span class='hs-varop'>$</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>$</span> <span class='hs-conid'>L</span><span class='hs-varop'>.</span><span class='hs-varid'>length</span> <span class='hs-varid'>bytes</span> <span class='hs-varop'>+</span> <span class='hs-num'>5</span>
<a name="line-132"></a>    <span class='hs-varid'>putLazyByteString</span> <span class='hs-varid'>bytes</span>
<a name="line-133"></a>    <span class='hs-varid'>putWord8</span> <span class='hs-num'>0x00</span>
<a name="line-134"></a>  <span class='hs-keyword'>where</span>
<a name="line-135"></a>    <span class='hs-varid'>bytes</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>runPut</span> <span class='hs-varid'>p</span>
<a name="line-136"></a><span class='hs-comment'>{-# INLINE putAsDocument #-}</span>
<a name="line-137"></a>
<a name="line-138"></a><a name="putDocument"></a><span class='hs-definition'>putDocument</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Document</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Put</span>
<a name="line-139"></a><span class='hs-definition'>putDocument</span> <span class='hs-varid'>doc</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>putAsDocument</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Doc</span><span class='hs-varop'>.</span><span class='hs-varid'>foldlWithKey'</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-varid'>return</span> <span class='hs-conid'>()</span><span class='hs-layout'>)</span> <span class='hs-varid'>doc</span>
<a name="line-140"></a>  <span class='hs-keyword'>where</span>
<a name="line-141"></a>    <span class='hs-varid'>f</span> <span class='hs-varid'>a</span> <span class='hs-varid'>k</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a</span> <span class='hs-varop'>*&gt;</span> <span class='hs-varid'>putField</span> <span class='hs-varid'>k</span> <span class='hs-varid'>v</span>
<a name="line-142"></a><span class='hs-comment'>{-# INLINE putDocument #-}</span>
<a name="line-143"></a>
<a name="line-144"></a><a name="getDocument"></a><span class='hs-definition'>getDocument</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Get</span> <span class='hs-conid'>Document</span>
<a name="line-145"></a><span class='hs-definition'>getDocument</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-146"></a>    <span class='hs-varid'>l</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getWord32le</span>
<a name="line-147"></a>    <span class='hs-varid'>bytes</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getLazyByteString</span> <span class='hs-varop'>$</span> <span class='hs-varid'>l</span> <span class='hs-comment'>-</span> <span class='hs-num'>4</span>
<a name="line-148"></a>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Doc</span><span class='hs-varop'>.</span><span class='hs-varid'>fromList</span> <span class='hs-varop'>$</span> <span class='hs-varid'>runGet</span> <span class='hs-varid'>getFields</span> <span class='hs-varid'>bytes</span>
<a name="line-149"></a> <span class='hs-keyword'>where</span>
<a name="line-150"></a>    <span class='hs-varid'>getFields</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lookAhead</span> <span class='hs-varid'>getWord8</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>done</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>done</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<a name="line-151"></a>        <span class='hs-keyword'>then</span> <span class='hs-varid'>return</span> <span class='hs-conid'>[]</span>
<a name="line-152"></a>        <span class='hs-keyword'>else</span> <span class='hs-layout'>(</span><span class='hs-conop'>:</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getField</span>
<a name="line-153"></a>                 <span class='hs-varop'>&lt;*&gt;</span> <span class='hs-varid'>getFields</span>
<a name="line-154"></a><span class='hs-comment'>{-# INLINE getDocument #-}</span>
<a name="line-155"></a>
<a name="line-156"></a><a name="putArray"></a><span class='hs-definition'>putArray</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Array</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Put</span>
<a name="line-157"></a><span class='hs-definition'>putArray</span> <span class='hs-varid'>array</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>putAsDocument</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Vector</span><span class='hs-varop'>.</span><span class='hs-varid'>zipWithM_</span> <span class='hs-varid'>putField</span> <span class='hs-varid'>inf</span> <span class='hs-varid'>array</span>
<a name="line-158"></a>  <span class='hs-keyword'>where</span>
<a name="line-159"></a>    <span class='hs-varid'>inf</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Vector</span><span class='hs-varop'>.</span><span class='hs-varid'>generate</span> <span class='hs-layout'>(</span><span class='hs-conid'>Vector</span><span class='hs-varop'>.</span><span class='hs-varid'>length</span> <span class='hs-varid'>array</span><span class='hs-layout'>)</span> <span class='hs-varid'>intToText</span>
<a name="line-160"></a><span class='hs-comment'>{-# INLINE putArray #-}</span>
<a name="line-161"></a>
<a name="line-162"></a><a name="getArray"></a><span class='hs-definition'>getArray</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Get</span> <span class='hs-conid'>Array</span>
<a name="line-163"></a><span class='hs-definition'>getArray</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>getDocument</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>doc</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-164"></a>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Vector</span><span class='hs-varop'>.</span><span class='hs-varid'>generate</span> <span class='hs-layout'>(</span><span class='hs-conid'>Doc</span><span class='hs-varop'>.</span><span class='hs-varid'>size</span> <span class='hs-varid'>doc</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-varid'>doc</span><span class='hs-layout'>)</span>
<a name="line-165"></a>  <span class='hs-keyword'>where</span>
<a name="line-166"></a>    <span class='hs-comment'>-- TODO(superbobry): actually, we can switch to</span>
<a name="line-167"></a>    <span class='hs-comment'>-- 'fromJust . lookup' and completely ignore invalid BSON.</span>
<a name="line-168"></a>    <span class='hs-varid'>f</span> <span class='hs-varid'>doc</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Doc</span><span class='hs-varop'>.</span><span class='hs-varid'>lookupDefault</span> <span class='hs-conid'>ValueNull</span> <span class='hs-layout'>(</span><span class='hs-varid'>intToText</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>doc</span>
<a name="line-169"></a><span class='hs-comment'>{-# INLINE getArray #-}</span>
<a name="line-170"></a>
<a name="line-171"></a><a name="putBinary"></a><span class='hs-definition'>putBinary</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Binary</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Put</span>
<a name="line-172"></a><span class='hs-definition'>putBinary</span> <span class='hs-varid'>binary</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-173"></a>    <span class='hs-varid'>putWord32le</span> <span class='hs-varop'>$</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>$</span> <span class='hs-conid'>S</span><span class='hs-varop'>.</span><span class='hs-varid'>length</span> <span class='hs-varid'>payload</span>
<a name="line-174"></a>    <span class='hs-varid'>putWord8</span> <span class='hs-varid'>tag</span>
<a name="line-175"></a>    <span class='hs-varid'>putByteString</span> <span class='hs-varid'>payload</span>
<a name="line-176"></a>  <span class='hs-keyword'>where</span>
<a name="line-177"></a>    <span class='hs-layout'>(</span><span class='hs-varid'>tag</span><span class='hs-layout'>,</span> <span class='hs-varid'>payload</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>binary</span> <span class='hs-keyword'>of</span>
<a name="line-178"></a>        <span class='hs-conid'>BinaryGeneric</span> <span class='hs-varid'>a</span>     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_GENERIC_BINARY</span><span class='hs-layout'>,</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-179"></a>        <span class='hs-conid'>BinaryFunction</span> <span class='hs-varid'>a</span>    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_FUNCTION</span><span class='hs-layout'>,</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-180"></a>        <span class='hs-conid'>BinaryUuid</span> <span class='hs-varid'>a</span>        <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_UUID</span><span class='hs-layout'>,</span> <span class='hs-varid'>lazyByteStringToStrict</span> <span class='hs-varop'>$</span> <span class='hs-conid'>UUID</span><span class='hs-varop'>.</span><span class='hs-varid'>toByteString</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-181"></a>        <span class='hs-conid'>BinaryMd5</span> <span class='hs-varid'>a</span>         <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_MD5</span><span class='hs-layout'>,</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-182"></a>        <span class='hs-conid'>BinaryUserDefined</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSON_USER_DEFINED_BINARY</span><span class='hs-layout'>,</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-183"></a><span class='hs-comment'>{-# INLINE putBinary #-}</span>
<a name="line-184"></a>
<a name="line-185"></a><a name="getBinary"></a><span class='hs-definition'>getBinary</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Get</span> <span class='hs-conid'>Binary</span>
<a name="line-186"></a><span class='hs-definition'>getBinary</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-187"></a>    <span class='hs-varid'>len</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getWord32le</span>
<a name="line-188"></a>    <span class='hs-varid'>tag</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getWord8</span>
<a name="line-189"></a>    <span class='hs-varid'>bytes</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getByteString</span> <span class='hs-varid'>len</span>
<a name="line-190"></a>    <span class='hs-keyword'>case</span> <span class='hs-varid'>tag</span> <span class='hs-keyword'>of</span>
<a name="line-191"></a>        <span class='hs-conid'>BSON_GENERIC_BINARY</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>BinaryGeneric</span> <span class='hs-varid'>bytes</span>
<a name="line-192"></a>        <span class='hs-conid'>BSON_FUNCTION</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>BinaryFunction</span> <span class='hs-varid'>bytes</span>
<a name="line-193"></a>        <span class='hs-conid'>BSON_BINARY_OLD</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>BinaryGeneric</span> <span class='hs-varid'>bytes</span>
<a name="line-194"></a>        <span class='hs-conid'>BSON_UUID_OLD</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mkUuid</span> <span class='hs-varid'>bytes</span>
<a name="line-195"></a>        <span class='hs-conid'>BSON_UUID</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mkUuid</span> <span class='hs-varid'>bytes</span>
<a name="line-196"></a>        <span class='hs-conid'>BSON_MD5</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>BinaryMd5</span> <span class='hs-varid'>bytes</span>
<a name="line-197"></a>        <span class='hs-conid'>BSON_USER_DEFINED_BINARY</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>BinaryUserDefined</span> <span class='hs-varid'>bytes</span>
<a name="line-198"></a>        <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>fail</span> <span class='hs-varop'>$</span> <span class='hs-varid'>printf</span> <span class='hs-str'>"Invalid BSON binary subtype: %i"</span> <span class='hs-varid'>tag</span>
<a name="line-199"></a>  <span class='hs-keyword'>where</span>
<a name="line-200"></a>    <span class='hs-varid'>mkUuid</span> <span class='hs-varid'>bytes</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-conid'>UUID</span><span class='hs-varop'>.</span><span class='hs-varid'>fromByteString</span> <span class='hs-varop'>$</span> <span class='hs-varid'>strictByteStringToLazy</span> <span class='hs-varid'>bytes</span> <span class='hs-keyword'>of</span>
<a name="line-201"></a>        <span class='hs-conid'>Just</span> <span class='hs-varid'>uuid</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>BinaryUuid</span> <span class='hs-varid'>uuid</span>
<a name="line-202"></a>        <span class='hs-conid'>Nothing</span>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>fail</span> <span class='hs-str'>"Invalid BSON binary uuid"</span>
<a name="line-203"></a><span class='hs-comment'>{-# INLINE getBinary #-}</span>
<a name="line-204"></a>
<a name="line-205"></a><a name="putObjectId"></a><span class='hs-definition'>putObjectId</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ObjectId</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Put</span>
<a name="line-206"></a><span class='hs-definition'>putObjectId</span> <span class='hs-conid'>ObjectId</span> <span class='hs-layout'>{</span> <span class='hs-keyglyph'>..</span> <span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-207"></a>    <span class='hs-varid'>putWord32le</span> <span class='hs-varid'>objectIdTime</span>
<a name="line-208"></a>    <span class='hs-varid'>putWord24le</span> <span class='hs-varid'>objectIdMachine</span>
<a name="line-209"></a>    <span class='hs-varid'>putWord16le</span> <span class='hs-varid'>objectIdPid</span>
<a name="line-210"></a>    <span class='hs-varid'>putWord24le</span> <span class='hs-varid'>objectIdInc</span>
<a name="line-211"></a><span class='hs-comment'>{-# INLINE putObjectId #-}</span>
<a name="line-212"></a>
<a name="line-213"></a><a name="getObjectId"></a><span class='hs-definition'>getObjectId</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Get</span> <span class='hs-conid'>ObjectId</span>
<a name="line-214"></a><span class='hs-definition'>getObjectId</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ObjectId</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getWord32le</span>
<a name="line-215"></a>                       <span class='hs-varop'>&lt;*&gt;</span> <span class='hs-varid'>getWord24le</span>
<a name="line-216"></a>                       <span class='hs-varop'>&lt;*&gt;</span> <span class='hs-varid'>getWord16le</span>
<a name="line-217"></a>                       <span class='hs-varop'>&lt;*&gt;</span> <span class='hs-varid'>getWord24le</span>
<a name="line-218"></a><span class='hs-comment'>{-# INLINE getObjectId #-}</span>
<a name="line-219"></a>
<a name="line-220"></a><a name="putUtcTime"></a><span class='hs-definition'>putUtcTime</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>UTCTime</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Put</span>
<a name="line-221"></a><span class='hs-definition'>putUtcTime</span> <span class='hs-varid'>time</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>putWord64le</span> <span class='hs-varop'>$</span> <span class='hs-varid'>round</span> <span class='hs-varop'>$</span> <span class='hs-varid'>utcTimeToPOSIXSeconds</span> <span class='hs-varid'>time</span> <span class='hs-varop'>*</span> <span class='hs-num'>1000</span>
<a name="line-222"></a><span class='hs-comment'>{-# INLINE putUtcTime #-}</span>
<a name="line-223"></a>
<a name="line-224"></a><a name="getUtcTime"></a><span class='hs-definition'>getUtcTime</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Get</span> <span class='hs-conid'>UTCTime</span>
<a name="line-225"></a><span class='hs-definition'>getUtcTime</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-226"></a>    <span class='hs-varid'>time</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getWord64le</span>
<a name="line-227"></a>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-varid'>posixSecondsToUTCTime</span> <span class='hs-varop'>$</span> <span class='hs-varid'>fromInteger</span> <span class='hs-varop'>$</span> <span class='hs-varid'>time</span> <span class='hs-varop'>`div`</span> <span class='hs-num'>1000</span>
<a name="line-228"></a><span class='hs-comment'>{-# INLINE getUtcTime #-}</span>
<a name="line-229"></a>
<a name="line-230"></a><a name="putRegexOptions"></a><span class='hs-definition'>putRegexOptions</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RegexOptions</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Put</span>
<a name="line-231"></a><span class='hs-definition'>putRegexOptions</span> <span class='hs-varid'>opts</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BitSet</span><span class='hs-varop'>.</span><span class='hs-varid'>foldl'</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-varid'>pure</span> <span class='hs-conid'>()</span><span class='hs-layout'>)</span> <span class='hs-varid'>opts</span> <span class='hs-varop'>*&gt;</span> <span class='hs-varid'>putWord8</span> <span class='hs-num'>0x00</span>
<a name="line-232"></a>  <span class='hs-keyword'>where</span>
<a name="line-233"></a>    <span class='hs-varid'>f</span> <span class='hs-varid'>a</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>put</span> <span class='hs-varop'>$</span> <span class='hs-varid'>match</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-varop'>*&gt;</span> <span class='hs-varid'>a</span>
<a name="line-234"></a>    <span class='hs-varid'>match</span> <span class='hs-conid'>RegexOptionCaseInsensitive</span> <span class='hs-keyglyph'>=</span> <span class='hs-chr'>'i'</span>
<a name="line-235"></a>    <span class='hs-varid'>match</span> <span class='hs-conid'>RegexOptionLocaleDependent</span> <span class='hs-keyglyph'>=</span> <span class='hs-chr'>'l'</span>
<a name="line-236"></a>    <span class='hs-varid'>match</span> <span class='hs-conid'>RegexOptionMultiline</span>       <span class='hs-keyglyph'>=</span> <span class='hs-chr'>'m'</span>
<a name="line-237"></a>    <span class='hs-varid'>match</span> <span class='hs-conid'>RegexOptionDotall</span>          <span class='hs-keyglyph'>=</span> <span class='hs-chr'>'s'</span>
<a name="line-238"></a>    <span class='hs-varid'>match</span> <span class='hs-conid'>RegexOptionUnicode</span>         <span class='hs-keyglyph'>=</span> <span class='hs-chr'>'u'</span>
<a name="line-239"></a>    <span class='hs-varid'>match</span> <span class='hs-conid'>RegexOptionVerbose</span>         <span class='hs-keyglyph'>=</span> <span class='hs-chr'>'x'</span>
<a name="line-240"></a><span class='hs-comment'>{-# INLINE putRegexOptions #-}</span>
<a name="line-241"></a>
<a name="line-242"></a><a name="getRegexOptions"></a><span class='hs-definition'>getRegexOptions</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Get</span> <span class='hs-conid'>RegexOptions</span>
<a name="line-243"></a><span class='hs-definition'>getRegexOptions</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span><span class='hs-varop'>.</span><span class='hs-varid'>foldl'</span> <span class='hs-varid'>f</span> <span class='hs-conid'>BitSet</span><span class='hs-varop'>.</span><span class='hs-varid'>empty</span><span class='hs-layout'>)</span> <span class='hs-varid'>getLazyByteStringNul</span>
<a name="line-244"></a>  <span class='hs-keyword'>where</span>
<a name="line-245"></a>    <span class='hs-varid'>f</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>flip</span> <span class='hs-conid'>BitSet</span><span class='hs-varop'>.</span><span class='hs-varid'>insert</span> <span class='hs-varid'>c</span> <span class='hs-varop'>.</span> <span class='hs-varid'>match</span>
<a name="line-246"></a>    <span class='hs-varid'>match</span> <span class='hs-chr'>'i'</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>RegexOptionCaseInsensitive</span>
<a name="line-247"></a>    <span class='hs-varid'>match</span> <span class='hs-chr'>'l'</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>RegexOptionLocaleDependent</span>
<a name="line-248"></a>    <span class='hs-varid'>match</span> <span class='hs-chr'>'m'</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>RegexOptionMultiline</span>
<a name="line-249"></a>    <span class='hs-varid'>match</span> <span class='hs-chr'>'s'</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>RegexOptionDotall</span>
<a name="line-250"></a>    <span class='hs-varid'>match</span> <span class='hs-chr'>'u'</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>RegexOptionUnicode</span>
<a name="line-251"></a>    <span class='hs-varid'>match</span> <span class='hs-chr'>'x'</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>RegexOptionVerbose</span>
<a name="line-252"></a>    <span class='hs-varid'>match</span> <span class='hs-varid'>v</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>error</span> <span class='hs-varop'>$</span> <span class='hs-varid'>printf</span> <span class='hs-str'>"Invalind BSON regex option: %c"</span> <span class='hs-varid'>v</span>
<a name="line-253"></a><span class='hs-comment'>{-# INLINE getRegexOptions #-}</span>
<a name="line-254"></a>
<a name="line-255"></a><a name="putJsWithScope"></a><span class='hs-definition'>putJsWithScope</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Document</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Put</span>
<a name="line-256"></a><span class='hs-definition'>putJsWithScope</span> <span class='hs-varid'>code</span> <span class='hs-varid'>document</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-257"></a>    <span class='hs-varid'>putWord32le</span> <span class='hs-varop'>$</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>$</span> <span class='hs-conid'>L</span><span class='hs-varop'>.</span><span class='hs-varid'>length</span> <span class='hs-varid'>bytes</span> <span class='hs-varop'>+</span> <span class='hs-num'>4</span>
<a name="line-258"></a>    <span class='hs-varid'>putLazyByteString</span> <span class='hs-varid'>bytes</span>
<a name="line-259"></a>  <span class='hs-keyword'>where</span>
<a name="line-260"></a>      <span class='hs-varid'>bytes</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>runPut</span> <span class='hs-varop'>$</span> <span class='hs-keyword'>do</span>
<a name="line-261"></a>          <span class='hs-varid'>putString</span> <span class='hs-varid'>code</span>
<a name="line-262"></a>          <span class='hs-varid'>putDocument</span> <span class='hs-varid'>document</span>
<a name="line-263"></a><span class='hs-comment'>{-# INLINE putJsWithScope #-}</span>
<a name="line-264"></a>
<a name="line-265"></a><a name="getJsWithScope"></a><span class='hs-definition'>getJsWithScope</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Get</span> <span class='hs-layout'>(</span><span class='hs-conid'>Text</span><span class='hs-layout'>,</span> <span class='hs-conid'>Document</span><span class='hs-layout'>)</span>
<a name="line-266"></a><span class='hs-definition'>getJsWithScope</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-267"></a>    <span class='hs-varid'>len</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getWord32le</span>
<a name="line-268"></a>    <span class='hs-varid'>bytes</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getLazyByteString</span> <span class='hs-varop'>$</span> <span class='hs-varid'>len</span> <span class='hs-comment'>-</span> <span class='hs-num'>4</span>
<a name="line-269"></a>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-varid'>flip</span> <span class='hs-varid'>runGet</span> <span class='hs-varid'>bytes</span> <span class='hs-varop'>$</span> <span class='hs-keyword'>do</span>
<a name="line-270"></a>        <span class='hs-varid'>code</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getString</span>
<a name="line-271"></a>        <span class='hs-varid'>document</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getDocument</span>
<a name="line-272"></a>        <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-varid'>code</span><span class='hs-layout'>,</span> <span class='hs-varid'>document</span><span class='hs-layout'>)</span>
<a name="line-273"></a><span class='hs-comment'>{-# INLINE getJsWithScope #-}</span>
<a name="line-274"></a>
<a name="line-275"></a><a name="putCString"></a><span class='hs-definition'>putCString</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Put</span>
<a name="line-276"></a><span class='hs-definition'>putCString</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-277"></a>    <span class='hs-varid'>putByteString</span> <span class='hs-varop'>$</span> <span class='hs-conid'>TE</span><span class='hs-varop'>.</span><span class='hs-varid'>encodeUtf8</span> <span class='hs-varid'>s</span>
<a name="line-278"></a>    <span class='hs-varid'>putWord8</span> <span class='hs-num'>0x00</span>
<a name="line-279"></a><span class='hs-comment'>{-# INLINE putCString #-}</span>
<a name="line-280"></a>
<a name="line-281"></a><a name="getCString"></a><span class='hs-definition'>getCString</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Get</span> <span class='hs-conid'>Text</span>
<a name="line-282"></a><span class='hs-definition'>getCString</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TE</span><span class='hs-varop'>.</span><span class='hs-varid'>decodeUtf8</span> <span class='hs-varop'>.</span> <span class='hs-conid'>S</span><span class='hs-varop'>.</span><span class='hs-varid'>concat</span> <span class='hs-varop'>.</span> <span class='hs-conid'>L</span><span class='hs-varop'>.</span><span class='hs-varid'>toChunks</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getLazyByteStringNul</span>
<a name="line-283"></a><span class='hs-comment'>{-# INLINE getCString #-}</span>
<a name="line-284"></a>
<a name="line-285"></a><a name="putString"></a><span class='hs-definition'>putString</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Put</span>
<a name="line-286"></a><span class='hs-definition'>putString</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>bytes</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TE</span><span class='hs-varop'>.</span><span class='hs-varid'>encodeUtf8</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>in</span> <span class='hs-keyword'>do</span>
<a name="line-287"></a>    <span class='hs-varid'>putWord32le</span> <span class='hs-varop'>$</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-varop'>.</span><span class='hs-varid'>length</span> <span class='hs-varid'>bytes</span> <span class='hs-varop'>+</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
<a name="line-288"></a>    <span class='hs-varid'>putByteString</span> <span class='hs-varid'>bytes</span>
<a name="line-289"></a>    <span class='hs-varid'>putWord8</span> <span class='hs-num'>0x00</span>
<a name="line-290"></a><span class='hs-comment'>{-# INLINE putString #-}</span>
<a name="line-291"></a>
<a name="line-292"></a><a name="getString"></a><span class='hs-definition'>getString</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Get</span> <span class='hs-conid'>Text</span>
<a name="line-293"></a><span class='hs-definition'>getString</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-294"></a>    <span class='hs-varid'>len</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getWord32le</span>
<a name="line-295"></a>    <span class='hs-varid'>payload</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getByteString</span> <span class='hs-varop'>$</span> <span class='hs-varid'>len</span> <span class='hs-comment'>-</span> <span class='hs-num'>1</span>
<a name="line-296"></a>    <span class='hs-varid'>getWord8</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>z</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>z</span> <span class='hs-keyword'>of</span>
<a name="line-297"></a>        <span class='hs-num'>0x00</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>TE</span><span class='hs-varop'>.</span><span class='hs-varid'>decodeUtf8</span> <span class='hs-varid'>payload</span>
<a name="line-298"></a>        <span class='hs-keyword'>_</span>    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>fail</span> <span class='hs-str'>"BSON string is not NULL terminated"</span>
<a name="line-299"></a><span class='hs-comment'>{-# INLINE getString #-}</span>
<a name="line-300"></a>
<a name="line-301"></a><a name="getBool"></a><span class='hs-definition'>getBool</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Get</span> <span class='hs-conid'>Bool</span>
<a name="line-302"></a><span class='hs-definition'>getBool</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>getWord8</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>v</span> <span class='hs-keyword'>of</span>
<a name="line-303"></a>    <span class='hs-num'>0x00</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-conid'>False</span>
<a name="line-304"></a>    <span class='hs-num'>0x01</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-conid'>True</span>
<a name="line-305"></a>    <span class='hs-keyword'>_</span>    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>fail</span> <span class='hs-varop'>$</span> <span class='hs-varid'>printf</span> <span class='hs-str'>"Invalind BSON boolean: %i"</span> <span class='hs-varid'>v</span>
<a name="line-306"></a><span class='hs-comment'>{-# INLINE getBool #-}</span>
<a name="line-307"></a>
<a name="line-308"></a><a name="putWord24le"></a><span class='hs-definition'>putWord24le</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word24</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Put</span>
<a name="line-309"></a><span class='hs-definition'>putWord24le</span> <span class='hs-varid'>w</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-310"></a>    <span class='hs-varid'>putWord8</span> <span class='hs-varop'>$</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>w</span>
<a name="line-311"></a>    <span class='hs-varid'>putWord8</span> <span class='hs-varop'>$</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>$</span> <span class='hs-varid'>shiftR</span> <span class='hs-varid'>w</span> <span class='hs-num'>8</span>
<a name="line-312"></a>    <span class='hs-varid'>putWord8</span> <span class='hs-varop'>$</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>$</span> <span class='hs-varid'>shiftR</span> <span class='hs-varid'>w</span> <span class='hs-num'>16</span>
<a name="line-313"></a><span class='hs-comment'>{-# INLINE putWord24le #-}</span>
<a name="line-314"></a>
<a name="line-315"></a><a name="getWord24le"></a><span class='hs-definition'>getWord24le</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Get</span> <span class='hs-conid'>Word24</span>
<a name="line-316"></a><span class='hs-definition'>getWord24le</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-317"></a>    <span class='hs-varid'>b1</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getWord8</span>
<a name="line-318"></a>    <span class='hs-varid'>b2</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getWord8</span>
<a name="line-319"></a>    <span class='hs-varid'>b3</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>getWord8</span>
<a name="line-320"></a>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-varid'>fromInteger</span> <span class='hs-varop'>$</span> <span class='hs-varid'>shiftL</span> <span class='hs-varid'>b3</span> <span class='hs-num'>16</span> <span class='hs-varop'>.|.</span> <span class='hs-varid'>shiftL</span> <span class='hs-varid'>b2</span> <span class='hs-num'>8</span> <span class='hs-varop'>.|.</span> <span class='hs-varid'>b1</span>
<a name="line-321"></a><span class='hs-comment'>{-# INLINE getWord24le #-}</span>
<a name="line-322"></a>
<a name="line-323"></a><a name="intToText"></a><span class='hs-definition'>intToText</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Text</span>
<a name="line-324"></a><span class='hs-definition'>intToText</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-varid'>toStrict</span> <span class='hs-varop'>.</span> <span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-varid'>toLazyText</span> <span class='hs-varop'>.</span> <span class='hs-varid'>decimal</span>
<a name="line-325"></a><span class='hs-comment'>{-# INLINE intToText #-}</span>
<a name="line-326"></a>
<a name="line-327"></a><a name="lazyByteStringToStrict"></a><span class='hs-definition'>lazyByteStringToStrict</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>L</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>S</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span>
<a name="line-328"></a><a name="strictByteStringToLazy"></a><span class='hs-definition'>strictByteStringToLazy</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>S</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>L</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span>
<a name="line-329"></a><span class='hs-cpp'>#if MIN_VERSION_bytestring(0, 10, 0)</span>
<a name="line-330"></a><span class='hs-definition'>lazyByteStringToStrict</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>L</span><span class='hs-varop'>.</span><span class='hs-varid'>toStrict</span>
<a name="line-331"></a><span class='hs-definition'>strictByteStringToLazy</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>L</span><span class='hs-varop'>.</span><span class='hs-varid'>fromStrict</span>
<a name="line-332"></a><span class='hs-cpp'>#else</span>
<a name="line-333"></a><span class='hs-definition'>lazyByteStringToStrict</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-varop'>.</span><span class='hs-varid'>concat</span> <span class='hs-varop'>.</span> <span class='hs-conid'>L</span><span class='hs-varop'>.</span><span class='hs-varid'>toChunks</span>
<a name="line-334"></a><span class='hs-definition'>strictByteStringToLazy</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>L</span><span class='hs-varop'>.</span><span class='hs-varid'>fromChunks</span> <span class='hs-varop'>.</span> <span class='hs-varid'>return</span>
<a name="line-335"></a><span class='hs-cpp'>#endif</span>
<a name="line-336"></a><span class='hs-comment'>{-# INLINE lazyByteStringToStrict #-}</span>
<a name="line-337"></a><span class='hs-comment'>{-# INLINE strictByteStringToLazy #-}</span>
</pre></body>
</html>
